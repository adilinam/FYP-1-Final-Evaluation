modeltype ECORE uses "http://www.eclipse.org/emf/2002/Ecore";

transformation continue_perf(inout eModel : ECORE);

import emf.tools;

mapping main() { 

	var numberOfIterations := 1000;
	var startTime := currentTimeMillis();
	
	var x := 0;
	while(true) { 
		var o1 := object EClass{};
		var o2 := o1.map toEClass();
		eModel.removeElement(o2);
		eModel.removeElement(o1);
		
		x := 1 + x;
		switch {
			case (x < numberOfIterations) continue;
			else break;
		}
	};
	assert fatal (x = numberOfIterations);
	
	dump("Elapsed: " + (currentTimeMillis() - startTime).toString());

	startTime := currentTimeMillis();
	
	x := 0;
	while(true) { 
		var o1 := object EClass{};
		var o2 := o1.map toEClass();
		eModel.removeElement(o2);
		eModel.removeElement(o1);
		
		x := 1 + x;
		switch {
			case (x < numberOfIterations) true;
			else break;
		}
	};
	assert fatal (x = numberOfIterations);
	
	dump("Elapsed: " + (currentTimeMillis() - startTime).toString());

}

mapping EClass::toEClass() : EClass {
}

